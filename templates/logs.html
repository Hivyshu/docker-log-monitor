<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Logs - {{ current_file }}</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-light">
<div class="container mt-4">
  <h2>Logs - {{ current_file }}</h2>
  <form id="filterForm" class="mb-3">
    <select name="severity" class="form-select w-auto d-inline">
      <option value="">All</option>
      <option value="INFO" {% if severity=='INFO' %}selected{% endif %}>INFO</option>
      <option value="WARNING" {% if severity=='WARNING' %}selected{% endif %}>WARNING</option>
      <option value="ERROR" {% if severity=='ERROR' %}selected{% endif %}>ERROR</option>
    </select>
    <input type="text" name="search" placeholder="Search keyword" class="form-control w-auto d-inline" value="{{ keyword }}">
    <input type="hidden" name="file" value="{{ current_file }}">
    <button class="btn btn-primary">Filter</button>
    <a class="btn btn-success" href="/download?file={{ current_file }}">Download</a>
    <a class="btn btn-secondary" href="/">Home</a>
  </form>
  <pre id="logContent" class="border p-3 bg-dark text-light" style="height:500px; overflow:auto;">
{% for line in logs %}
<span class="{% if 'ERROR' in line %}text-danger{% elif 'WARNING' in line %}text-warning{% else %}text-white{% endif %}">{{ line }}</span>
{% endfor %}
  </pre>
</div>

<script>
  // Auto-refresh every 5 seconds
  setInterval(() => {
    $.get(window.location.href, function(data){
      const newContent = $(data).find("#logContent").html();
      $("#logContent").html(newContent);
    });
  }, 5000);
</script>

</body>
</html>
